# 외부 이슈 등록 시스템 PRD

## 1. 배경 & 목표

### 1.1 배경
- 사내에서 Gitea, Redmine을 사용해 개발 이슈와 업무를 관리하고 있음.
- 외부/비개발 인력이 쉽게 이슈를 등록할 수 있는 통합 창구가 부족함.
- 메신저, 이메일, 구두 요청 등으로 이슈가 흩어져 누락·중복이 발생함.

### 1.2 목표
- 웹 브라우저에서 접근 가능한 단일 이슈 등록 페이지 제공.
- 등록된 이슈를 n8n을 통해 Gitea/Redmine에 자동 생성.
- 관리자가 이슈 현황·진행상태를 한 곳에서 확인할 수 있는 최소한의 대시보드 확보.

### 1.3 성공 지표 (예시)
- 수동 이슈 등록(카톡, 메일 등) 비율 80% 이상 감소.
- 이슈 등록 후 Gitea/Redmine에 반영되는 평균 시간 1분 이내.
- 주요 팀에서 외부 폼 사용 비율 90% 이상.

---

## 2. 사용자 & 주요 시나리오

### 2.1 사용자 유형
- 일반 직원 / 외부 협력사
  - 웹폼을 통해 이슈를 등록만 하는 사용자.
- 관리자 / 개발 리드
  - 이슈 현황, 진행률, 담당자별 작업량을 확인하고, 우선순위 및 상태를 조정하는 사용자.

### 2.2 핵심 시나리오

1. 일반 사용자가 웹폼에 접속해서 이슈를 입력하고 제출한다.
2. n8n이 Webhook으로 데이터를 받고, Gitea 또는 Redmine에 이슈를 생성한다.
3. 관리자는 Gitea/Redmine UI 또는 대시보드에서 이슈 상태를 확인·업데이트한다.

---

## 3. 기능 요구사항

### 3.1 이슈 등록 웹폼

#### 3.1.1 필수 입력 필드
- 프로젝트: 문자열 혹은 드롭다운 (예: `internal-tools`, `customer-portal` 등).
- 제목: 문자열.
- 이슈 타입: 버그 / 기능 요청 / 일반 작업 등.
- 우선순위: 낮음 / 보통 / 높음 / 치명적.
- 내용: 상세 설명(멀티라인 텍스트).

#### 3.1.2 선택 입력 필드
- 요청자 정보: 이름/이메일.
- 첨부파일 링크 또는 스크린샷 URL.
- 추가 메타데이터(필요 시): 브라우저/OS, 모듈명, 버전 등.

#### 3.1.3 동작
- 사용자가 폼을 작성하고 “등록” 버튼을 누르면, n8n Webhook 엔드포인트로 HTTP POST(JSON) 호출.
- 성공 시:
  - “이슈 등록 완료” 메시지 표시.
  - 필요 시, 간단한 이슈 접수 번호 또는 시간 표시.
- 실패 시:
  - “등록 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.” 등의 에러 메시지 표시.
  - (선택) 일정 시간 후 자동 재시도 안내 또는 문의 연락처 제공.

---

### 3.2 n8n 워크플로우

#### 3.2.1 트리거
- Webhook 노드:
  - HTTP 메서드: POST.
  - 요청 본문 형식: JSON.
  - 외부 폼에서 전송되는 필드(프로젝트, 제목, 이슈 타입, 우선순위, 내용, 요청자 등)를 그대로 수신.

#### 3.2.2 처리 로직
- 입력값 검증:
  - 필수 필드 누락 여부 확인(프로젝트, 제목, 내용 등).
  - 문자열 길이 제한, 허용되지 않은 값(이슈 타입, 우선순위 등) 체크.
- 라우팅:
  - 프로젝트/이슈 타입 등에 따라 Gitea 또는 Redmine 중 어느 시스템에 이슈를 생성할지 결정.
- 이슈 생성:
  - Gitea:
    - REST API(이슈 생성 엔드포인트)를 호출하여 해당 리포지토리에 이슈 생성.
    - 제목, 내용, 라벨(이슈 타입/우선순위), 담당자 등 매핑.
  - Redmine:
    - REST API(`/issues.json`) 또는 n8n Redmine 노드를 사용해 이슈 생성.
    - 프로젝트 ID, 트래커(버그/기능 등), 우선순위, 설명, 요청자 정보 등을 매핑.
- 알림 (선택):
  - 이슈 생성 후, 슬랙/메일 등으로 요약 정보 전송.
  - 예: 프로젝트명, 제목, 우선순위, 링크 URL.

#### 3.2.3 에러 처리
- Gitea/Redmine API 호출 실패 시:
  - 재시도 로직(예: 일정 횟수, 일정 간격)을 적용할지 여부 정의.
  - 실패 시 관리자에게 알림(슬랙/메일 등).
- 로그:
  - 원본 요청 데이터(민감정보 제외)와 오류 메시지를 로그 스토리지에 저장.
  - 추후 디버깅 및 장애 분석을 위한 최소한의 정보 보존.

---

### 3.3 관리자용 대시보드 (1단계 버전)

#### 3.3.1 최소 요구사항
- Gitea 또는 Redmine의 기본 UI·필터·검색 기능을 활용해 다음을 확인할 수 있어야 한다.
  - 상태별 이슈 목록: 열림 / 진행중 / 완료 / 보류 등.
  - 프로젝트별 이슈 목록 및 수량.
  - 담당자별 할당 이슈 목록.
- 관리자 관점에서 “지금 무엇이 얼마나 쌓여 있는지”를 빠르게 파악 가능해야 한다.

#### 3.3.2 향후 확장 (선택)
- n8n에서 주기적으로 Gitea/Redmine의 이슈 데이터를 수집하여:
  - 상태별 이슈 개수, 평균 해결 시간, 신규/종료 이슈 추이 등을 집계.
  - DB 또는 스프레드시트(예: 내부 DB, 구글시트 등)에 저장.
- 시각화:
  - Grafana/Metabase/시트 차트 등으로:
    - 오픈 이슈 수 추이,
    - 프로젝트별/담당자별 작업량,
    - SLA(예: 3일 이상 미처리 이슈 수) 등을 시각화.

---

## 4. 기술 요구사항

### 4.1 인프라

- Gitea, Redmine:
  - 내부 네트워크(예: Tailscale) 상에 이미 구축되어 있음.
- n8n:
  - 내부 환경에 설치.
  - Webhook 엔드포인트만 외부에서 접근 가능하도록 역프록시 또는 Tailscale Funnel/유사 솔루션 사용.
- 웹폼 호스팅:
  - 정적 사이트(HTML/JS)로 구성.
  - 외부에서 접근 가능한 도메인에 연결(예: `issues.example.com`).

### 4.2 보안

- 통신:
  - 웹폼 → n8n Webhook 구간은 HTTPS 사용.
- 인증:
  - Webhook 엔드포인트에 시크릿 토큰, Basic Auth, 또는 IP/레이트 리밋 등 적용.
- 자격 증명:
  - Gitea/Redmine API 토큰은 서버 측 환경변수/시크릿 스토리지에 보관.
  - 코드/리포지토리에 직접 토큰을 포함하지 않도록 관리.

### 4.3 성능·규모

- 예상 트래픽:
  - 1일 수십~수백 건 수준의 이슈 등록을 가정.
- 응답 시간:
  - 이슈 등록 후 실제 Gitea/Redmine에 생성되기까지 수 초 이내.
- 모니터링:
  - n8n 워크플로우 실행 성공/실패 카운트, 오류 로그를 통해 기본적인 상태 모니터링.

---

## 5. 비기능 요구사항

### 5.1 사용성

- 비개발자도 이해할 수 있는 필드 이름과 설명 사용.
- 필요 이상 복잡한 필드는 숨기고, 필수 정보 위주로 설계.
- 모바일 브라우저(스마트폰)에서도 사용 가능한 레이아웃과 입력 UX.

### 5.2 유지보수성

- 프로젝트 목록, 이슈 타입, 우선순위 등은 설정 파일 또는 n8n 변수로 관리.
  - 코드 수정 없이 값 추가/변경이 가능하도록 설계.
- n8n 워크플로우 버전 관리:
  - 변경 시 내역 기록 및 백업.
  - 가능하다면 Git 저장소와 연동하여 JSON export를 버전 관리.

---

## 6. 범위 & 우선순위

### 6.1 Must-have (1차 릴리스)
- 외부 이슈 등록 웹폼 구현.
- n8n Webhook + Gitea/Redmine 이슈 생성 워크플로우.
- 관리자/개발자가 Gitea/Redmine 기본 UI를 통해 이슈를 조회·관리.

### 6.2 Nice-to-have (후속)
- 통합 대시보드:
  - 상태별 그래프, 처리시간 통계, SLA 모니터링 등.
- 알림 기능:
  - 이슈 생성/상태 변경 시 메신저/메일로 알림.
- 권한 제어:
  - 특정 사용자만 접근 가능한 내부 전용 폼 또는 로그인 연동.
